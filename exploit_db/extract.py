# extract_exploitdb.py
import requests

EXPLOITDB_CSV_URL = "https://gitlab.com/exploit-database/exploitdb/-/raw/main/files_exploits.csv"

def extract_exploit_csv_text(timeout: int = 120) -> str:
    """
    Download ExploitDB CSV feed and return CSV text (in-memory).
    """
    print(f"⬇️ Downloading ExploitDB CSV from {EXPLOITDB_CSV_URL}")
    resp = requests.get(EXPLOITDB_CSV_URL, timeout=timeout)
    resp.raise_for_status()
    resp.encoding = resp.encoding or "utf-8"
    print("✅ Download complete")
    return resp.text


if __name__ == "__main__":
    print(extract_exploit_csv_text()[:200])
